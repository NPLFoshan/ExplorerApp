<html>
<body>
<pe:mcml>
    <script refresh='false' type='text/npl' src='MainPage.lua'>
        <![CDATA[
            -- UI
            local MainPage = NPL.load('(gl)Mod/ExplorerApp/components/MainPage.lua')
            local Sort = NPL.load('(gl)Mod/ExplorerApp/components/Sort/Sort.lua')
            local KpUserTag = NPL.load('(gl)script/apps/Aries/Creator/Game/mcml/keepwork/KpUserTag.lua')
            local ShareWorld = NPL.load('(gl)Mod/WorldShare/cellar/ShareWorld/ShareWorld.lua')
            local LoginModal = NPL.load('(gl)Mod/WorldShare/cellar/LoginModal/LoginModal.lua')
            local VipPage = NPL.load('(gl)script/apps/Aries/Creator/Game/Tasks/User/VipPage.lua')
            
            -- service
            local KeepworkService = NPL.load('(gl)Mod/WorldShare/service/KeepworkService.lua')
            local KeepworkServiceSession = NPL.load('(gl)Mod/WorldShare/service/KeepworkService/Session.lua')

            -- lib
            local UniString = commonlib.gettable('System.Core.UniString')

            local page = document:GetPageCtrl()

            global_type = type

            function select_category(index)
                page:GetNode('worksTree'):SetUIAttribute('DataSource', {})

                select_value = nil

                MainPage.curPage = 1
                MainPage:SetWorksTree(MainPage.categoryTree[index])
            end

            function search()
                MainPage.curPage = 1
                MainPage.isSearching = false

                MainPage:Search()
            end

            function close()
                MainPage:CanGoBack()
            end

            function select_project(index)
                MainPage.curSelected = index
                page:Refresh(0.01)
            end

            function enter(index)
                MainPage:SelectProject(index)
            end

            function download(index)
                MainPage:DownloadWorld(index)
            end

            function myfavorite(index)
                MainPage:SetFavorite(index)
            end

            function set_coins()
                MainPage:SetCoins()
            end

            function get_image(cover)
                if not cover then
                    return [[position: relative;
                             top: 0px;
                             left: 0px;
                             width: 250px;
                             height: 120px;
                             background:;']]
                else
                    return [[position: relative;
                             top: 0px;
                             left: 0px;
                             width: 250px;
                             height: 120px;
                             background:url(]] .. cover .. [[);]]
                end
            end

            function select_sort()
                local x, y, width, height = _guihelper.GetLastUIObjectPos()

                Sort:ShowPage(x, y)
            end

            function get_cur_sort()
                return MainPage:GetSortList()[MainPage:GetSortIndex()].value
            end

            function select_downloaded_category(value)
                local page = MainPage:GetPage()
            
                if not page then
                    return false
                end

                if value == 'all' then
                    page:SetValue('downloaded_game_local', false)
                elseif value == 'local' then
                    page:SetValue('downloaded_game_all', false)
                end

                page:Refresh(0.01)

                MainPage:SelectDownloadedCategory(value)
            end

            function is_load_more_items(index)
                if index == #MainPage.worksTree then
                    return true
                end
            end

            function lazy_load()
                if MainPage.worksTree[#MainPage.worksTree].isLoaded then
                    return false
                end

                MainPage.worksTree[#MainPage.worksTree].isLoaded = true
                MainPage.curPage = MainPage.curPage + 1

                Mod.WorldShare.MsgBox:Close()

                if MainPage.isSearching then
                    MainPage:Search()
                elseif MainPage.isFavorite then
                    MainPage:SetMyFavoriteWorksTree()
                elseif MainPage.isClassList then
                    MainPage:SetMyClassListWorksTree()
                else
                    MainPage:SetWorksTree(MainPage.categorySelected)
                end
            end

            function get_page_size()
                return #MainPage.worksTree
            end

            function go_project_web(id)
                MainPage:OpenProject(id)
            end

            function get_project_url_text(id)
                return format('%s/pbl/project/%d/', KeepworkService:GetKeepworkUrl(), id or 0)
            end

            function is_english()
                return MainPage:IsEnglish()
            end

            function get_english_style(styleStr)
                if is_english() then
                    return styleStr
                end
            end

            function get_menubar_button_value()
                local value = Eval('value')

                if value == '最新' then
                    return [[<img style='width: 83px;
                                         height: 19px;
                                         margin-left: 23px;
                                         margin-top:10px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#248 360 83 19' />]]
                end

                if value == '热门' then
                    return [[<img style='width: 79px;
                                         height: 26px;
                                         margin-left: 27px;
                                         margin-top:6px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#367 357 79 26' />]]
                end

                if value == '大赛作品' then
                    return [[<img style='width: 89px;
                                         height: 27px;
                                         margin-left: 23px;
                                         margin-top: 6px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#19 357 89 27' />]]
                end

                if value == '编程' then
                    return [[<img style='width: 81px;
                                         height: 27px;
                                         margin-left: 25px;
                                         margin-top: 6px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#250 485 81 27' />]]
                end
                
                if value == '短片' then
                    return [[<img style='width: 80px;
                                         height: 24px;
                                         margin-left: 25px;
                                         margin-top: 7px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#138 486 80 24' />]]
                end

                if value == '互动' then
                    return [[<img style='width: 80px;
                                         height: 29px;
                                         margin-left: 25px;
                                         margin-top: 6px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#364 440 80 29' />]]
                end

                if value == '场景' then
                    return [[<img style='width: 83px;
                                         height: 28px;
                                         margin-left: 23px;
                                         margin-top: 6px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#16 483 83 28' />]]
                end

                if value == '机器人' then
                    return [[<img style='width: 91px;
                                         height: 25px;
                                         margin-left: 26px;
                                         margin-top: 7px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#480 441 91 25' />]]
                end

                if value == '计算机' then
                    return [[<img style='width: 91px;
                                         height: 23px;
                                         margin-left: 26px;
                                         margin-top: 8px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#479 401 91 23' />]]
                end

                if value == '科学' then
                    return [[<img style='width: 78px;
                                         height: 26px;
                                         margin-left: 29px;
                                         margin-top: 7px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#141 441 78 26' />]]
                end

                if value == '语文' then
                    return [[<img style='width: 75px;
                                         height: 26px;
                                         margin-left: 31px;
                                         margin-top: 7px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#255 441 75 26' />]]
                end

                if value == '数学' then
                    return [[<img style='width: 75px;
                                         height: 25px;
                                         margin-left: 32px;
                                         margin-top: 8px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#256 400 75 25' />]]
                end

                if value == '生物' then
                    return [[<img style='width: 76px;
                                         height: 28px;
                                         margin-left: 31px;
                                         margin-top: 6px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#143 398 76 28' />]]
                end

                if value == '人文' then
                    return [[<img style='width: 77px;
                                         height: 26px;
                                         margin-left: 29px;
                                         margin-top: 6px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#21 441 77 26' />]]
                end

                if value == '艺术' then
                    return [[<img style='width: 76px;
                                         height: 28px;
                                         margin-left: 31px;
                                         margin-top: 5px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#370 398 76 28' />]]
                end

                if value == '设计' then
                    return [[<img style='width: 76px;
                                         height: 28px;
                                         margin-left: 31px;
                                         margin-top: 7px;'
                                  src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#23 399 76 28' />]]
                end

                return '<div style="margin-top: 8px;">' .. value .. '</div>'
            end

            function get_menubar_button_style()
                if Eval('color') == 'YELLOW' then
                    if Eval('value') == MainPage.categorySelected.value then
                        return 'menubar_button_selected'
                    else
                        return 'menubar_button'
                    end
                elseif Eval('color') == 'BLACK' then
                    if Eval('value') == MainPage.categorySelected.value then
                        return 'main_page_black_button_selected'
                    else
                        return 'main_page_black_button'
                    end
                end
            end

            function has_rated()
                if Eval('point') then
                    return true
                else
                    return false
                end
            end

            function has_username()
                local username = Eval('username')

                if username then
                    return true
                else
                    return false
                end
            end

            function get_art_number()
                local point = Eval('point')

                if not point or
                    global_type(point) ~= 'number'  then
                    return ''
                end

                local number = point
                local n = math.floor(1)
                local fmt = '%.' .. n .. 'f'
                local nRet = tonumber(string.format(fmt, number))

                number = tostring(nRet)

                local returnString = ''

                for item in string.gmatch(number, '.') do
                    if item == '1' then
                        returnString = returnString .. [[<img style='width: 11px;height: 18px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png;108 287 11 18' />]]
                    end

                    if item == '2' then
                        returnString = returnString .. [[<img style='width: 14px;height: 18px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png;122 287 14 18' />]]
                    end

                    if item == '3' then
                        returnString = returnString .. [[<img style='width: 11px;height: 20px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png;139 286 11 20' />]]
                    end

                    if item == '4' then
                        returnString = returnString .. [[<img style='width: 14px;height: 18px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png;152 287 15 18' />]]
                    end
                    
                    if item == '5' then
                        returnString = returnString .. [[<img style='width: 14px;height: 19px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png;170 287 15 19' />]]
                    end

                    if item == '6' then
                        returnString = returnString .. [[<img style='width: 14px;height: 19px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png;188 287 14 19' />]]
                    end

                    if item == '7' then
                        returnString = returnString .. [[<img style='width: 14px;height: 18px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png;204 287 14 18' />]]
                    end
                        
                    if item == '8' then
                        returnString = returnString .. [[<img style='width: 15px;height: 19px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png;221 287 15 19' />]]
                    end
                        
                    if item == '9' then
                        returnString = returnString .. [[<img style='width: 13px;height: 19px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png;257 287 13 19' />]]
                    end

                    if item == '0' then
                        returnString = returnString .. [[<img style='width: 15px;height: 19px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png;238 287 15 19' />]]
                    end
                        
                    if item == '.' then
                        returnString = returnString .. [[<img style='width: 6px;height: 7px;margin-top: 11px;margin-right: 2px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png;273 293 6 7' />]]
                    end
                end

                return returnString
            end

            function get_world_date()
                if Eval('updated_at') then
                    local allStr = ''
                    local timestamp = Mod.WorldShare.Utils:UnifiedTimestampFormat(Eval('updated_at'))
                    local formatDate = os.date('%Y-%m-%d %H:%M', timestamp)
                    local recentDate = Mod.WorldShare.Utils:RecentDatetimeFormat(timestamp)

                    return [[<div>
                                <div style='position: relative'>]] .. formatDate .. [[</div>
                                <div align='right'
                                     style='text-align: right;
                                            width: 80px;
                                            height: 20px;'>
                                        ]] .. recentDate .. [[
                                </div>
                            </div>]]
                else
                    reutrn ''
                end
            end

            function get_project_views()
                local total_view = Eval('total_view')

                if total_view and global_type(total_view) == 'number' then
                    return total_view
                else
                    return 0
                end
            end

            function get_project_thumbs()
                local total_like = Eval('total_like')

                if total_like and global_type(total_like) == 'number' then
                    return total_like
                else
                    return 0
                end 
            end

            function get_project_favorites()
                local total_mark = Eval('total_mark')

                if not total_mark or
                   global_type(total_mark) ~= 'number' or
                   total_mark < 0 then
                    return 0
                end

                return Eval('total_mark')
            end

            function get_project_comments()
                local total_comment = Eval('total_comment')

                if total_comment and global_type(total_comment) == 'number' then
                    return total_comment
                else
                    return 0
                end 
            end

            function is_vip()
                return Eval('isVipWorld')
            end

            function get_work_item_style()
                if MainPage.curSelected == Eval('index') then
                    if is_vip() then
                        return 'work_item_vip_selected'
                    else
                        return 'work_item_selected'
                    end
                else
                    return 'work_item'
                end
            end

            function is_selected()
                if MainPage.curSelected == Eval('index') then
                    return true
                else
                    return false
                end
            end

            function get_user_icon()
                local user = Eval('user')

                if not user or global_type(user) ~= 'table' then
                    return ''
                end

                local user_info = {}
                local count = 0

                if user.tLevel and user.tLevel >= 1 then
                    user_info.tLevel = 1
                    count = count + 1
                end
                    
                if user.student and user.student == 1 then
                    user_info.student = 1
                    count = count + 1
                end

                if user.vip and user.vip == 1 then
                    user_info.vip = 1
                    count = count + 1
                end

                return KpUserTag.GetMcml(user_info)
            end

            function get_username()
                local user = Eval('user')

                if not user or global_type(user) ~= 'table' then
                    return Eval('username') or '<%= "暂无" %>'
                end

                if user.username then
                    return user.username
                else
                    return Eval('username') or '<%= "暂无" %>'
                end
            end

            function share(index)
                local currentWorld = MainPage.worksTree[index]

                if currentWorld and currentWorld.id then
                    ShareWorld:ShowWorldCode(currentWorld.id)
                end
            end

            function get_like_button_style()
                if Eval('isFavorite') then
                    return 'unlike_button'
                else
                    return 'like_button'
                end
            end

            function my_favorite_projects()
                MainPage.curPage = 1
                MainPage:SetMyFavoriteWorksTree()
            end

            function show_my_school_list()
                if my_school_popup then
                    my_school_popup = false
                    page:FindControl('my_school_popup').visible = false
                else
                    my_school_popup = true
                    page:FindControl('my_school_popup').visible = true
                end
            end

            function select_class(id)
                show_my_school_list()
                MainPage.curPage = 1
                MainPage:SetMyClassListWorksTree(id)
            end

            function has_school()
                if Eval('user') and Eval('user').school and Eval('user').school.name then
                    return true
                else
                    return false
                end
            end

            function on_mouse_enter(index)
                for i = 1, #MainPage.worksTree do
                    local name = 'double_click_mask_' .. i
                    local ctx = page:FindControl(name)

                    if ctx then
                        ctx.visible = false
                    end
                end

                page:FindControl('double_click_mask_' .. index).visible = true
            end

            function on_mouse_leave(index)
                page:FindControl('double_click_mask_' .. index).visible = false
            end

            function on_mouse_enter_share_button(index)
                page:FindControl('share_button_gray_' .. index).visible = false
                page:FindControl('share_button_blue_' .. index).visible = true
            end

            function on_mouse_leave_share_button(index)
                page:FindControl('share_button_gray_' .. index).visible = true
                page:FindControl('share_button_blue_' .. index).visible = false
            end

            function get_item_padding_style()
                local index = Eval('index')
                local style = ''

                if index <= 3 then
                    style = style .. 'padding-top: 13px;'
                else
                    style = style .. 'padding-top: 5px;'
                end

                if ((index - 1) % 3) == 0 then
                    style = style .. 'padding-left: 20px;'
                else
                    style = style .. 'padding-left: 12px;'
                end

                return style
            end

            function favorite(index)
                page:FindControl('favorite_item_' .. index).visible = false
                page:FindControl('favorited_item_' .. index).visible = true

                local worldinfo = MainPage.worksTree[index]

                keepwork.world.favorite({objectType = 5, objectId = worldinfo.id}, function(status)
                    worldinfo.isFavorite = true
                    worldinfo.total_mark = worldinfo.total_mark + 1
                    page:CallMethod('worksTree', 'DataBind')
                end)
            end

            function unfavorite(index)
                page:FindControl('favorite_item_' .. index).visible = true
                page:FindControl('favorited_item_' .. index).visible = false

                local worldinfo = MainPage.worksTree[index]

                keepwork.world.unfavorite({objectType = 5, objectId = worldinfo.id}, function(status)
                    worldinfo.isFavorite = false
                    worldinfo.total_mark = worldinfo.total_mark - 1
                    page:CallMethod('worksTree', 'DataBind')
                end)
            end

            function is_favorite(type)
                local worldinfo = MainPage.worksTree[Eval('index')]

                if worldinfo.isFavorite then
                    if type == 1 then
                        return 'false'
                    elseif type == 2 then
                        return 'true'
                    end
                else
                    if type == 1 then
                        return 'true'
                    elseif type == 2 then
                        return 'false'
                    end
                end
            end

            function star(index)
                -- KeepworkServiceSession:AddRice('thumbsup')

                page:FindControl('star_item_' .. index).visible = false
                page:FindControl('stared_item_' .. index).visible = true

                local worldinfo = MainPage.worksTree[index]

                keepwork.world.star({router_params = {id = worldinfo.id}}, function(err, msg, data)
                    worldinfo.isStar = true
                    worldinfo.total_like = worldinfo.total_like + 1
                    page:CallMethod('worksTree', 'DataBind')
                end)
            end

            function unstar(index)
                if true then
                    return
                end

                page:FindControl('star_item_' .. index).visible = true
                page:FindControl('stared_item_' .. index).visible = false

                local worldinfo = MainPage.worksTree[index]

                keepwork.world.star({router_params = {id = worldinfo.id}}, function(err, msg, data)
                    worldinfo.isStar = false
                    worldinfo.total_like = worldinfo.total_like - 1
                    page:Refresh(0.01)
                end)
            end

            function is_star(type)
                local worldinfo = MainPage.worksTree[Eval('index')]

                if worldinfo.isStar then
                    if type == 1 then
                        return 'false'
                    elseif type == 2 then
                        return 'true'
                    end
                else
                    if type == 1 then
                        return 'true'
                    elseif type == 2 then
                        return 'false'
                    end
                end
            end

            function get_numbers_width()
                local views_width = _guihelper.GetTextWidth(tostring(Mod.WorldShare.Utils.ShortNumber(get_project_views())))
                local thumbs_width = _guihelper.GetTextWidth(tostring(Mod.WorldShare.Utils.ShortNumber(get_project_thumbs())))
                local favorite_width = _guihelper.GetTextWidth(tostring(Mod.WorldShare.Utils.ShortNumber(get_project_favorites())))

                local total = views_width + thumbs_width + favorite_width

                return 'width: ' .. (total + 75) .. 'px;'
            end

            function open_vip()
                GameLogic.IsVip('RedSummerCampMain', true, function(result)
                    if result then
                        -- force show vip page
                        VipPage.ShowPage('red_summer_camp_main')
                    end
                end)
            end

            function submit_opus()
                local content = [[
                    <div width='100%%'
                         style='padding: 30px;
                                font-size: 16px;
                                base-font-size: 16px;'>
                        <div align='center'
                             style='width: 106px;
                                    font-size: 26px;
                                    base-font-size: 26px;
                                    margin-bottom: 30px;'><%%= L'提交作品' %%></div>
                        <div>
                            <%%= L'如果你也想让你的作品展示在推荐列表中，让更多的人看到你的优秀作品，那么你可以将作品通过自荐的方式提交给我们。' %%>
                        </div>
                        <div style='margin-top: 20px;'>
                            <%%= L'作品要求：' %%>
                        </div>
                        <div>
                            <%%= L'1.作品内容积极向上，且内容完整；' %%>
                        </div>
                        <div>
                            <%%= L'2.作品有创意，在创作思路或技术上有独特表现；' %%>
                        </div>
                        <div>
                            <%%= L'3.参赛获奖作品优先采纳。' %%>
                        </div>
                        <div style='margin-top: 20px;'>
                            <%%= L'提交方式：' %%>
                        </div>
                        <div>
                            <%%= L'将作品项目ID及作品说明，通过邮件发送至' %%>
                            <a href='mailto:support@paracraft.cn'>support@paracraft.cn</a>
                        </div>
                        <div style='margin-top: 20px;'>
                            <%%= L'作品提交模板：' %%>
                        </div>
                        <div class='theme1_gray_container_background'
                             width='100%%'
                             style='height: 130px;
                                    padding-top: 15px;
                                    padding: 20px;
                                    color: #000000;'>
                            <div align='right'
                                 onclick='copy'
                                 style='width: 32px;
                                        top: 40px;
                                        color: #0000FF;
                                        position: relative;'>
                                <%%= L'复制' %%>
                                <div style='height: 1px;
                                            width: 32px;
                                            background-color: #0000FF;'></div>
                            </div>
                            <div><%%= L'账号：' %%></div>
                            <div><%%= L'作品ID：' %%></div>
                            <div><%%= L'参加的大赛及获奖名次：' %%></div>
                            <div><%%= L'作品说明：' %%></div>
                        </div>
                    </div>
                ]]

                local script = [[
                    local Toast = NPL.load('(gl)Mod/ExplorerApp/components/Toast/Toast.lua')
                    local example = '账号：\n作品ID：\n参加的大赛及获奖名次：\n作品说明：'

                    function copy()
                        ParaMisc.CopyTextToClipboard(example)
                        Toast:ShowPage(L'已复制', 3000)
                    end
                ]]

                local mcss = [[
                    <style type='type/mcss' src='Mod/WorldShare/cellar/Theme/Mcss/Theme1.mcss'></style>
                ]]

                Mod.WorldShare.MsgBox:ShowNotice(content, script, mcss, 560, 580)
            end
        ]]>
    </script>
    <style type='text/mcss' src='Mod/ExplorerApp/components/Theme/Mcss/MainPageMcss.mcss'>
        {
            close = {
                ['margin-top'] = 8,
                ['margin-right'] = 10,
                float = 'left',
                width = 65,
                height = 28,
                background = 'Texture/Aries/Creator/keepwork/explorer_32bits.png#61 131 16 16:3 3 3 3',
                color = '#ffffff'
            },
            area = {
                color = 'white'
            },
            strip = {
                height = 40,
                width = 1100,
            },
            title = {
                position = 'relative',
                ['margin-left'] = 12,
                ['margin-top'] = 12
            },
            area_content = {
                width = 1150,
            },
            menubar = {
                float = 'left',
                width = 170,
                height = 600,
                ['margin-left'] = 25,
                ['margin-top'] = 10,
            },
            menubar_button = {
                width = 140,
                height = 40,
                background = 'Texture/Aries/Creator/keepwork/explorer_32bits.png#336 125 32 32:10 10 10 10',
                ['margin-left'] = 4,
                ['margin-bottom'] = 6,
            },
            menubar_button_selected = {
                width = 140,
                height = 40,
                background = 'Texture/Aries/Creator/keepwork/explorer_32bits.png#299 125 32 32:10 10 10 10',
                ['margin-left'] = 4,
                ['margin-bottom'] = 6,
            },
            list = {
                float = 'left',
                width = 955,
            },
            downloaded_game = {
                float = 'left',
                width = 170,
                height = 30,
                ['margin-top'] = 22,
                ['padding-left'] = 5,
            },
            list_search_bar = {
                float = 'left',
                ['margin-left'] = 10,
                ['margin-top'] = 4,
                textcolor = '#ffffff',
                width = 316,
                height = 30,
                padding = 0,
                background = 'Texture/Aries/Creator/keepwork/explorer_32bits.png#205 162 32 16:5 5 5 5',
            },
            list_search_textfield = {
                width = 266,
                height = 30,
                background = '',
            },
            list_search_button = {
                position = 'relative',
                align = 'right',
                color = '#000000',
                background = 'Texture/Aries/Creator/keepwork/explorer_32bits.png#225 127 36 28:6 5 7 6',
                height = 30,
                width = 57,
                ['text-align'] = 'center',
                ['padding-top'] = 3,
                ['margin-top'] = -32
            },
            list_search_button_click = {
                postion = 'relative',
                height = 30,
                width = 57,
                ['margin-top'] = -25,
                background = ''
            },
            list_content = {
                ['margin-top'] = 5,
                ['padding-left'] = 0,
                ['padding-right'] = 10,
                ['padding-bottom'] = 10,
            },
            work_item = {
                height = 210,
                width = 285,
                ['margin-right'] = 10,
                ['margin-bottom'] = 10,
                ['padding-left'] = 9,
                ['padding-top'] = 9,
                background = 'Texture/Aries/Creator/keepwork/worldshare_32bits.png;435 212 30 30:11 11 11 11',
            },
            work_item_selected = {
                height = 210,
                width = 285,
                ['margin-right'] = 10,
                ['margin-bottom'] = 10,
                ['padding-left'] = 9,
                ['padding-top'] = 9,
                background = 'Texture/Aries/Creator/keepwork/worldshare_32bits.png;471 212 30 30:11 11 11 11',
            },
            work_item_vip_selected = {
                height = 210,
                width = 285,
                ['margin-right'] = 10,
                ['margin-bottom'] = 10,
                ['padding-left'] = 9,
                ['padding-top'] = 9,
                background = 'Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png;7 173 64 64:20 20 20 20',
            },
            work_item_info = {
                height = 60,
                width = 290,
                ['margin-left'] = 5,
                ['margin-top'] = 5
            },
            radius = {
                position = 'relative',
                height = 180,
                width = 250,
                background = 'Texture/Aries/Creator/keepwork/explorer_32bits.png;37 28 16 15:4 4 4 4',
            },
            download = {
                float = 'left'
                width = 30,
                height = 18,
                background = '',
            },
            download_icon = {
                width = 11,
                height = 11,
                ['margin-left'] = 8,
                ['margin-top'] = 3,
                background = 'Texture/Aries/Creator/keepwork/explorer_32bits.png;83 3 15 12',
            },
            favorite = {
                float = 'left',
                background = '',
                width = 30,
                height = 18
            },
            click = {
                position = 'relative',
                height = 270,
                width = 290,
                background = ''
            },
            like_button = {
                float = 'left',
                width = 38,
                height = 38,
                ['margin-right'] = 6,
                background = 'Texture/Aries/Creator/keepwork/ggs/user/renwuqiehuan/btn_shoucang_40X40_32bits.png#0 0 40 40'
            },
            unlike_button = {
                float = 'left',
                width = 38,
                height = 38,
                ['margin-right'] = 6,
                background = 'Texture/Aries/Creator/keepwork/ggs/user/renwuqiehuan/btn_yishoucang_40X40_32bits.png#0 0 40 40'
            },
            share_button = {
                float = 'left',
                width = 38,
                height = 38,
                ['margin-right'] = 6,
                background = 'Texture/Aries/Creator/keepwork/worldshare_32bits.png;109 459 40 40'
            },
            enter_button = {
                float = 'left',
                width = 46,
                height = 46,
                ['margin-right'] = 6,
                background = 'Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#445 282 46 46'
            },
            share_world_name = {
                ['text-singleline'] = 'true',
                width = 220,
                float = 'left',
                ['base-font-size'] = 16,
                ['font-size'] = 16,
                ['margin-top'] = 2,
                ['text-align'] = 'left',
                color = '#000000',
            },
            share_world_info = {
                ['text-singleline'] = 'true',
                float = 'left',
                ['margin-left'] = 0,
                height = 18,
                ['font-size'] = 12,
                color = '#9e9e9e',
            },
            vip_icon = {
                position = 'relative',
                width = 47,
                height = 52,
                ['margin-left'] = -28,
                ['margin-top'] = -20,
                background = 'Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#87 172 47 52'
            }
        }
    </style>
    <style type='type/mcss' src='Mod/WorldShare/cellar/Opus/OpusMcss.mcss'></style>
    <style type='type/mcss' src='Mod/WorldShare/cellar/Theme/Mcss/Theme1.mcss'></style>
    <pe:container
        alignment='_fi'
        zorder='-1'
        width='100%'
        height='100%'
        style='position:relative;
               background-color:#dcdcdc'>
    </pe:container>
    <pe:container
        alignment='_fi'
        zorder='-1'
        width='100%'
        height='100%'
        class='red_summer_camp_bg'>
    </pe:container>
    <div>
        <div>
            <div align='right'
                 style='width: 67px;
                        height: 70px;
                        position: relative;
                        margin-right: 20px;
                        margin-top: 8px;'>
                <div onclick='open_vip'
                     style='background: url(Texture/Aries/Creator/keepwork/RedSummerCamp/works/works_32bits.png#304 111 67 70);
                            width: 67px;
                            height: 70px;'></div>
            </div>
            <div style='background: url(Texture/Aries/Creator/keepwork/RedSummerCamp/courses/courses_32bits.png#7 249 169 56);
                        width: 169px;
                        height: 56px;
                        float: left;'>
                <div align='center'
                     onclick='close'
                     style='background: url(Texture/Aries/Creator/keepwork/RedSummerCamp/works/works_32bits.png#5 67 38 33);
                            width: 38px;
                            height: 33px;
                            margin-top: 12px;
                            margin-left: -20px;'></div>
            </div>
            <div style='float: left;
                        width: 283px;
                        height: 56px;
                        margin-left: -73px;
                        background: url(Texture/Aries/Creator/keepwork/RedSummerCamp/shentongbei/shentongbei_32bits.png#17 794 283 56)'>
                <div align='center'
                     style='background:;
                            color: #FFFFFF;
                            font-size: 20px;
                            base-font-size: 30px;
                            font-weight: bolder;
                            width: 85px;
                            height: 20px;
                            margin-top: 15px;
                            float: left;'>
                    <%= L'推荐列表' %>
                </div>
            </div>
            <div style='float: left;
                        margin-left: 10px;
                        font-size: 16px;
                        base-font-size: 16px;
                        font-weight: bold;
                        color: #1ca3d7;
                        margin-top: 18px;'
                 onclick='submit_opus'>
                <%= L'提交作品' %>
                <div style='height: 1px;
                            width: 66px;
                            background-color: #1ca3d7'></div>
            </div>
        </div>
        <div class='area'
             name='area'
             style='width: 1150px;'
             align='center'>
            <div class='strip'>
                <div style='float: left;
                            margin-left: 10px;
                            margin-top: 8px;
                            padding-left: 500px;'>
                    <input type='button'
                           onclick='show_my_school_list'
                           style='width: 140px;
                                  height: 24px;
                                  background: url(Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#544 33 140 24)' />
                    <pe:container name='my_school_popup'
                                  visible='false'
                                  zorder='1'
                                  style='position: relative;
                                         display:none;
                                         background:'>
                        <div style='width: 144px;
                                    height: 200px;
                                    margin-left: -2px;
                                    padding-top: 2px;
                                    padding-bottom: 2px;
                                    padding-left: 6px;
                                    padding-right: 6px;
                                    color: white;
                                    background: url(Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#306 169 68 68:18 18 18 18);'>
                            <pe:gridview name='class_list'>
                                <Columns>
                                    <div>
                                        <input type='button'
                                               style='width: 130px;
                                                      height: 20px;
                                                      margin-top: 6px;
                                                      color: #FFFFFF;
                                                      background: url()'
                                               onclick='select_class'
                                               value='<%= Eval("name") %>'
                                               name='<%= Eval("id") %>' />
                                    </div>
                                </Columns>
                            </pe:gridview>
                        </div>
                    </pe:container>
                </div>
                <div style='float: left;margin-left: 10px;margin-top: 8px;'>
                    <input type='button'
                           onclick='my_favorite_projects'
                           style='width: 110px;
                                  height: 24px;
                                  background: url(Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#544 69 110 24)' />
                </div>
                <div class='list_search_bar'>
                    <input type='text'
                           name='search_value'
                           class='list_search_textfield'
                           spacing='4'
                           EmptyText='<%= L"请输入你要搜索的内容" %>'
                           EmptyTextColor='#FF444444'
                           rows='1' />
                    <div class='list_search_button'>
                        <%=L'搜索'%>
                        <input type='button'
                               class='list_search_button_click'
                               DefaultButton='true'
                               onclick='search()' />
                    </div>
                </div>
            </div>
            <div class='area_content'>
                <div class='menubar'>
                    <div>
                        <pe:gridview RememberScrollPos='true'
                                     name='categoryTree'
                                     DefaultNodeHeight='48'
                                     pagesize='100' ItemsPerLine='1'
                                     AllowPaging='false'>
                            <Columns>
                                <div class='<%= get_menubar_button_style() %>'
                                     style='text-align: center;'>
                                    <div style='position: relative;'>
                                        <%= get_menubar_button_value() %>
                                    </div>
                                    <input type='button'
                                           style='position: relative;
                                                  width: 140px;
                                                  height: 40px;
                                                  background:;'
                                           name='<%= Eval("index") %>'
                                           onclick='select_category()' />
                                </div>
                            </Columns>
                        </pe:gridview>
                    </div>
                </div>
                <div class='list'>
                    <div class='list_content'>
                        <pe:gridview
                            RememberScrollPos='true'
                            name='worksTree'
                            style='padding-left: 20px;'
                            DefaultNodeHeight='235'
                            pagesize='<%= get_page_size %>'
                            ItemsPerLine='3'
                            VerticalScrollBarStep='100'
                            AllowPaging='false'>
                            <Columns>
                                <div style='<%= get_item_padding_style() %>'>
                                    <div class='<%= get_work_item_style() %>'>
                                        <input type='button' class='click' name='<%=Eval("index")%>' onclick='select_project' />
                                        <pe:if condition='<%= is_vip() %>' >
                                            <pe:container zorder='4' style='background:;'>
                                                <div class='vip_icon'></div>
                                            </pe:container>
                                        </pe:if>
                                        <pe:if condition='<%= has_rated() %>'>
                                            <pe:container zorder='3' style='position: relative;background: ;'>
                                                <pe:if condition='<%= is_vip() %>'>
                                                    <div style='width: 90x;height: 36px;
                                                            margin-top: -7px;
                                                            margin-left: -7px;
                                                            padding-top: 4px;
                                                            padding-left: 30px;
                                                            background: url(Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#651 231 90 36)'>
                                                        <%= get_art_number()%>
                                                    </div>
                                                </pe:if>
                                                <pe:if condition='<%= not is_vip() %>'>
                                                    <div style='width: 70px;height: 36px;
                                                            margin-top: -7px;
                                                            margin-left: -7px;
                                                            padding-top: 4px;
                                                            padding-left: 6px;
                                                            background: url(Texture/Aries/Creator/keepwork/worldshare_32bits.png#356 136 70 36)'>
                                                        <%= get_art_number()%>
                                                    </div>
                                                </pe:if>
                                            </pe:container>
                                        </pe:if>
                                        <div style='width: 265px;height: 130px;background-color: #afafaf;'>
                                            <pe:if condition='<%= not is_selected() %>'>
                                                <input type='button'
                                                       name='<%= Eval("index") %>'
                                                       onmouseenter='on_mouse_enter'
                                                       style='position: relative;
                                                              width: 265px;
                                                              height: 130px;
                                                              background:;' />
                                                <pe:container name='<%= "double_click_mask_" .. Eval("index") %>'
                                                              visible='false'
                                                              zorder='1'
                                                              style='position: relative;background:;'>
                                                    <div style='height: 130px;
                                                                width: 265px;
                                                                background: url(Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#705 32 66 64:10 10 10 10)'>
                                                        <img style='width: 85px;
                                                                    height: 17px;
                                                                    margin-top: 55px;
                                                                    margin-left: 95px;'
                                                             src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#784 35 85 17' />
                                                    </div>
                                                    <input type='button'
                                                           name='<%= Eval("index") %>'
                                                           onmouseleave='on_mouse_leave'
                                                           ondoubleclick='enter'
                                                           style='position: relative;
                                                                  width: 265px;
                                                                  height: 130px;
                                                                  margin-top: -130px;
                                                                  background:;' />
                                                </pe:container>
                                            </pe:if>
                                            <pe:if condition='<%= is_selected() %>'>
                                                <div style='position: relative;
                                                            width: 28px;
                                                            height: 26px;
                                                            margin-left: 230px;
                                                            margin-top: 5px;
                                                            background: url(Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#347 289 28 26);'>
                                                    <pe:container visible='true'
                                                                  name='<%= "share_button_gray_" .. Eval("index") %>'
                                                                  style='position: relative;background:;'>
                                                        <img src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#385 294 14 14'
                                                             style='width: 14px;
                                                                    height: 14px;
                                                                    margin-top: 4px;
                                                                    margin-left: 6px;' />
                                                    </pe:container>
                                                    <pe:container visible='false'
                                                                  name='<%= "share_button_blue_" .. Eval("index") %>'
                                                                  style='position: relative;background:;'>
                                                        <img src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#415 294 14 14'
                                                             style='width: 14px;
                                                                    height: 14px;
                                                                    margin-top: 4px;
                                                                    margin-left: 6px;' />
                                                    </pe:container>
                                                    <input type='button'
                                                           name='<%= Eval("index") %>'
                                                           onmouseenter='on_mouse_enter_share_button'
                                                           onmouseleave='on_mouse_leave_share_button'
                                                           onclick='share'
                                                           style='width: 28px;
                                                                  height: 26px;
                                                                  background: url();' />
                                                </div>
                                            </pe:if>
                                            <div style='position: relative;
                                                        width: 265px;
                                                        height: 130px;
                                                        background: url(Texture/Aries/Creator/keepwork/worldshare_32bits.png#394 211 32 32:9 9 9 9)'></div>
                                            <div style='<%= "width: 265px;height: 130px;background: url(" .. (Eval("cover") and Eval("cover") or "") .. ")" %>'>
                                                <pe:if condition='<%= has_username() %>'>
                                                    <div style='width: 265px;
                                                                height: 30px;
                                                                margin-top: 100px;
                                                                font-size: 12px;
                                                                padding-top: 5px;
                                                                padding-left: 4px;
                                                                color: #ffffff;
                                                                background-color: #000000a3'>
                                                        <%= get_user_icon() %>
                                                        <div style='float:left;margin-left: 4px;'>
                                                            <%= get_username() %>
                                                        </div>
                                                        <div align='right'
                                                             style='<%= "font-size: 12px;base-font-size: 12px;color: #FFFFFF;margin-top: 0px;height: 20px;float: left;" .. get_numbers_width() %>'>
                                                            <div style='float:left'>
                                                                <img src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#652 167 18 13'
                                                                     style='width: 18px;height: 13px;margin-top: 2px;' />
                                                                <div style='float:left;margin-left: 2px;max-width: 45px;'>
                                                                    <%= Mod.WorldShare.Utils.ShortNumber(get_project_views()) %>
                                                                </div>
                                                            </div>
                                                            <div style='float:left;margin-left: 8px;'>
                                                                <div style='float: left;width: 16px;height: 16px;'>
                                                                    <pe:container visible='<%= is_star(1) %>'
                                                                                  name='<%= "star_item_" .. Eval("index") %>'
                                                                                  style='position: relative;background:;'>
                                                                        <div>
                                                                            <img src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#704 166 16 15'
                                                                                 style='width: 16px;
                                                                                        height: 16px;
                                                                                        margin-top: 1px;' />
                                                                        </div>
                                                                        <input type='button'
                                                                               name='<%= Eval("index") %>'
                                                                               onclick='star()'
                                                                               style='background:;
                                                                                      width: 16px;
                                                                                      height: 17px;
                                                                                      margin-top: -16px;' />
                                                                    </pe:container>
                                                                    <pe:container visible='<%= is_star(2) %>'
                                                                                  name='<%= "stared_item_" .. Eval("index") %>'
                                                                                  style='position: relative;
                                                                                         background:;'>
                                                                        <div>
                                                                            <img src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#703 196 17 16'
                                                                                 style='width: 16px;
                                                                                        height: 16px;
                                                                                        margin-top: 1px;' />
                                                                        </div>
                                                                        <input type='button'
                                                                               name='<%= Eval("index") %>'
                                                                               onclick='unstar()'
                                                                               style='background:;
                                                                                      width: 16px;
                                                                                      height: 17px;
                                                                                      margin-top: -16px;' />
                                                                    </pe:container>
                                                                </div>
                                                                <div style='float:left;margin-left: 2px;max-width: 45px;'>
                                                                    <%= Mod.WorldShare.Utils.ShortNumber(get_project_thumbs()) %>
                                                                </div>
                                                            </div>
                                                            <div style='float:left;margin-left: 8px;'>
                                                                <div style='float: left;width: 16px;height: 16px;'>
                                                                    <pe:container visible='<%= is_favorite(1) %>'
                                                                                  name='<%= "favorite_item_" .. Eval("index") %>'
                                                                                  style='position: relative;
                                                                                         background:;'>
                                                                        <div>
                                                                            <img src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#747 166 16 15'
                                                                                 style='width: 16px;
                                                                                        height: 16px;
                                                                                        margin-top: 1px;' />
                                                                        </div>
                                                                        <input type='button'
                                                                               name='<%= Eval("index") %>'
                                                                               onclick='favorite()'
                                                                               style='background:;
                                                                                      width: 16px;
                                                                                      height: 17px;
                                                                                      margin-top: -16px;' />
                                                                    </pe:container>
                                                                    <pe:container visible='<%= is_favorite(2) %>'
                                                                                  name='<%= "favorited_item_" .. Eval("index") %>'
                                                                                  style='position: relative;
                                                                                         background:;'>
                                                                        <div>
                                                                            <img src='Texture/Aries/Creator/paracraft/paracraft_explorer_32bits.png#745 196 17 16'
                                                                                 style='width: 16px;
                                                                                        height: 16px;
                                                                                        margin-top: 1px;' />
                                                                        </div>
                                                                        <input type='button'
                                                                               name='<%= Eval("index") %>'
                                                                               onclick='unfavorite()'
                                                                               style='background:;
                                                                                      width: 16px;
                                                                                      height: 17px;
                                                                                      margin-top: -16px;' />
                                                                    </pe:container>
                                                                </div>
                                                                <div style='float: left;
                                                                            margin-left: 2px;
                                                                            max-width: 45px;'>
                                                                    <%= Mod.WorldShare.Utils.ShortNumber(get_project_favorites()) %>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </pe:if>
                                            </div>
                                        </div>
                                        <div class='work_item_info'>
                                            <div>
                                                <div class='share_world_name'>
                                                    <%= Mod.WorldShare.Utils.WordsLimit(Eval('name')) %>
                                                    <span style='color: #9e9e9e;'>
                                                        #<%= Eval('id') or '' %>
                                                    </span>
                                                </div>
                                            </div>
                                            <div style='position: relative;
                                                        margin-top: 10px;
                                                        float:left;
                                                        font-size: 12px;'>
                                                <pe:if condition='<%= has_school() %>'>
                                                    <div>
                                                        <img style='width: 19px;height: 16px;margin-right: 5px;' src='Texture/Aries/Creator/keepwork/worldshare_32bits.png#311 311 19 16' />
                                                        <%= Mod.WorldShare.Utils.WordsLimit(Eval('user').school.name) %>
                                                    </div>
                                                </pe:if>
                                            </div>
                                            <div align='right' style='margin-right: 14px;width: 58px;height: 46px;margin-top: -20x;'>
                                                <input type='button'
                                                       class='enter_button'
                                                       onclick='enter'
                                                       tooltip='<%= L"进入" %>'
                                                       name='<%= Eval("index") %>' />
                                            </div>
                                        </div>
                                        <pe:if condition='<%= is_load_more_items(Eval("index")) %>'>
                                            <pe:custom oncreate='<%= lazy_load %>'></pe:custom>
                                        </pe:if>
                                    </div>
                                </div>
                            </Columns>
                            <PagerSettings Position='Bottom' height='1' />
                        </pe:gridview>
                    </div>
                </div>
            </div>
        </div>
    </div>
</pe:mcml>
</body>
</html>